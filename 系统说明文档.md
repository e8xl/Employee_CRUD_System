# 员工成绩管理系统使用说明文档

## 一、系统概述

员工成绩管理系统是一个集成员工信息管理、考核成绩录入、职级历史追踪和职级预测分析等功能的综合性系统。本系统采用Python开发，基于PyQt5和PyQt-Fluent-Widgets构建用户界面，使用SQLite作为数据库存储引擎。

## 二、系统架构

系统采用MVC（模型-视图-控制器）架构设计：
- 模型层：存放在app/models目录，负责数据库操作和业务逻辑
- 视图层：存放在app/views目录，负责用户界面展示和交互
- 控制器：通过main_window.py和main.py协调模型与视图的交互

## 三、文件结构说明

### 1. 入口文件
- **run.py**：系统主程序入口，启动完整的员工管理系统
- **run_init.py**：系统初始化脚本，用于初次使用前的数据库创建和配置

### 2. 数据库初始化与维护
- **create_employee_db.py**：创建员工基础数据库并导入员工数据
- **create_score_tables.py**：创建考核成绩相关的数据库表
- **migrate_employee_grades.py**：将员工表中的职级数据迁移到职级历史表
- **fix_db.py**：数据库修复工具，解决数据异常问题
- **query_db.py**：数据库查询工具，用于调试和检查数据

### 3. 数据导入工具
- **import_aut.py**：导入AUT部门员工数据的专用脚本

## 四、数据库结构

系统使用单个SQLite数据库文件（`employee_db.sqlite`）存储所有数据，包含以下主要表：

### 1. 员工信息相关表
- **employees**：存储员工基本信息（工号、GID、姓名、部门等）
- **employee_grades**：存储员工职级历史记录
- **operation_logs**：记录系统操作日志

### 2. 考核成绩相关表
- **department_assessment_items**：部门考核项目配置
- **department_grade_formulas**：部门职级计算公式
- **employee_scores**：员工考核成绩记录
- **predicted_grades**：职级预测结果

## 五、系统初始化流程

首次使用系统时，需要执行以下步骤进行初始化：

1. **准备员工数据**：将员工名单准备为CSV格式，放置在`data/2025最新车间员工数据.csv`
2. **执行初始化脚本**：运行`python run_init.py`，该脚本会：
   - 创建员工数据库并导入基础数据
   - 创建考核成绩相关的表结构
   - 迁移员工职级历史数据

## 六、日常使用脚本说明

### 1. 系统启动
```
python run.py
```
启动员工管理系统主程序，用于日常使用。

### 2. 数据库重置
如需重置整个系统（谨慎操作！将删除所有数据）：
```
python run_init.py
```

### 3. 职级数据迁移
当员工表中有新的职级数据需要更新到职级历史表中时：
```
python migrate_employee_grades.py
```

### 4. 数据库修复
当数据库出现异常问题需要修复时：
```
python fix_db.py
```

## 七、数据导入导出说明

### 1. 员工数据导入
系统支持从Excel或CSV文件导入员工数据：
- 在系统界面中：点击导航栏的"导入数据"按钮
- 通过脚本导入：`python create_employee_db.py`（注意：会重建员工表！）

### 2. 成绩数据导入
考核成绩可通过以下方式导入：
- 在"员工成绩录入"界面：点击"导入成绩"按钮
- 导入格式要求：Excel或CSV文件，包含员工工号、考核项目名称、成绩和备注字段

### 3. 数据导出
系统提供以下导出功能：
- 员工数据导出：在员工管理界面点击"导出数据"按钮
- 成绩模板导出：在成绩录入界面点击"导出模板"按钮
- 预测结果导出：在职级预测分析界面点击"导出结果"按钮

## 八、常见问题解决

### 1. 数据库连接错误
错误信息：`无法连接到数据库`
解决方案：
- 检查`employee_db.sqlite`文件是否存在于项目根目录
- 确保数据库文件未被其他程序占用
- 尝试运行`python fix_db.py`修复数据库

### 2. 员工数据未显示
问题描述：系统启动后未显示员工数据
解决方案：
- 确认已执行`run_init.py`完成初始化
- 检查员工CSV数据格式是否正确
- 在系统中重新导入员工数据

### 3. 职级历史不显示
问题描述：员工详情页面中职级历史为空
解决方案：
- 执行`python migrate_employee_grades.py`迁移职级数据
- 确认员工表中有职级数据（grade_20XX字段）

## 九、开发环境要求

- Python 3.8或更高版本
- PyQt5和PyQt-Fluent-Widgets库
- SQLite3数据库
- pandas库（用于数据处理）

## 十、注意事项

1. **数据备份**：定期备份`employee_db.sqlite`文件，避免数据丢失
2. **初始化谨慎**：`run_init.py`会重建数据库，请在确保数据已备份的情况下执行
3. **数据格式**：导入的CSV文件应使用UTF-8编码，避免中文乱码
4. **权限设置**：确保程序对数据库文件有读写权限

## 十一、联系方式

如遇到使用问题或需要技术支持，请联系系统管理员。 